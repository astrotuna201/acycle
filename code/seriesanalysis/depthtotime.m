%                 depthtotime.m%% [time,sr]=depthtotime(depth,agemodel);%%  Converts depth scale to a time scale using a user-specified age model; written%  for use by geologists developing chronologies for stratigraphic sections.%%  Inputs:%%	depth = array with all sampled depths of original series (increasing order)%	agemodel = table with depth points assigned to specific times (increasing order)% %	Outputs:%%	time = array with times assigned to each depth of original series (increasing order)%	sr = sedimentation rate for intervals between successive depth points %%   Linda Hinnov, May 24, 2006%   Mingsong Li, studied in 14Dec2014function [time,sr]=depthtotime(depth,agemodel)sr=[ ];time=[ ];d=agemodel(:,1);t=agemodel(:,2);m=length(d);m1=m-1;n=length(depth);for i=2:m   j=i-1;   sr(j)=(d(i)-d(j))/(t(i)-t(j));     % sediment rateendfor j=1:m1    for i=1:n      if depth(i) >= d(j) & depth(i) <= d(j+1)  % winthin agemodel        time(i) = t(j) + (depth(i)-d(j))/sr(j);      end    endendfor i=1:n  if depth(i) <= d(1)                       % left part out of agemodel      time(i)= t(1) + (depth(i)-d(1))/sr(1);  end  if depth(i) >= d(m)                       % right part out of agemodel      time(i)=t(m1)+(depth(i)-d(m1))/sr(m1);  endend time = time';